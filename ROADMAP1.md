# План разработки консольной утилиты
### 0. Подготовительный этап - 31 минута
* 0.1. Включить таймер в Toggl - 1 минута
* 0.2. Прочитать требования проекта - 10 минут
* 0.3. Создать репозиторий на GitHub - 10 минут
* 0.4. Создать проект в IntelliJ IDEA (R1.8) - 10 минут
### 1. Подготовка тестовых данных - 15 минут
* 1.1. Описать пользователей - 5 минут

№ | Логин      |Пароль |           
--|------------|-------|
U1| `admin`      |`admin`  |
U2| `petr`       |`petr101`|
U3| `vasya`      |`123`    |
U4| `q`          |`!@#$`   |

* 1.2. Описать ресурсы (R1.12) - 10 минут

№ | Ресурс |Роль   | Пользователь|         
--|--------|-------|-------------|
R1| `A`      |`READ`   | `vasya`       |
R2| `A.B`    |`EXECUTE`| `admin`       |
R3| `A.B.C`  |`WRITE`  | `petr`       | 
R4| `A.B.D`  |`READ`   | `q`           |  
R5| `A.BB`   |`EXECUTE`| `petr`        |  
R6| `AB`     |`WRITE`  | `admin`       |
R7| `A`      |`READ`   | `admin`       |

### 2. Подготовка тестовых сценариев - 40 минут
* 2.1. Подготовить и записать тесты в bat/sh файл (R1.12) - 20 минут

№ | Входные данные      |Ожидаемый результат |           
----|------------|-------|
T1.1| `app.jar`      |1 + вывод справки  |
T1.2| `app.jar -h`       |1 + вывод справки|
T1.3| `app.jar -q`       |0 + вывод справки    |
T2.1| `app.jar -login vasya -pass 123`        |0   |
T2.2| `app.jar -login VASYA -pass 123`        |2   |
T2.3| `app.jar -login asd -pass asd`        |3   |
T2.4| `app.jar -login admin -pass 123`        |4   |
T2.5| `app.jar -login admin -pass admin`        |0   |
T3.1| `app.jar -login vasya -pass 123 -role READ -res A`        |0   |
T3.2| `app.jar -login vasya -pass 123 -role DELETE -res A `       |5   |
T3.3| `app.jar -login vasya -pass 123 -role WRITE -res A`        |6   |
T3.4| `app.jar -login vasya -pass 123 -role READ -res A.B `       |0   |
T3.5| `app.jar -login admin -pass admin -role READ -res A.B.C `       |0   |
T3.6| `app.jar -login petr -pass petr101 -role DELETE -res A.B.C`        |5   |
T3.7| `app.jar -login vasya -pass 123 -role DELETE -res A`        |5   |
T3.8| `app.jar -login vasya -pass 123 -role DELETE -res A.B.C`        |5   |
T3.9| `app.jar -login admin -pass admin -role READ -res A.B.D`        |0   |
T3.10| `app.jar -login admin -pass admin -role EXECUTE -res A`        |6   |
T4.1| `app.jar -login vasya -pass 123 -role READ -res A -ds 2020-03-12 -de 2020-03-13 -vol 10`       |0   |
T4.2| `app.jar -login vasya -pass 123 -role WRITE -res A -ds 2020-03-12 -de 2020-03-13 -vol 10`        |6   |
T4.3| `app.jar -login vasya -pass 123 -role READ -res A -ds 2020-03-13 -de 2020-03-12 -vol 10`        |7   |
T4.4| `app.jar -login vasya -pass 123 -role READ -res A -ds 2020/03/12 -de 2020/03/13 -vol 10`        |7   |
T4.5| `app.jar -login vasya -pass 123 -role READ -res A -ds 2020.03.12 -de 2020.03.13 -vol 10`        |7   |
* 2.2. Написать скрипт компиляции jar (R1.12) - 10 минут
* 2.3. Написать скрипт запуска утилиты (R1.12) - 10 минут
* 2.4. Cоздать класс `ExitCodes` (R1.9) - 10 минут
### 3. Простейшие сценарии - 20 минут
* 3.1. Создать метод для проверки наличия аргументов (R1.8) - 5 минут
* 3.2. Создать метод для вывода справки - 10 минут 
* 3.3. Создать метод для проверки необходимости вывода справки - 5 минут
    - 3.3.1. Вывести справку если `args[0]=="-h"` (код возврата: 1)
    - 3.3.2. Вывести справку если количество аргументов превышает/занижает норму (код возврата: 0)
    - 3.3.3. Вывести справку если передан неизвестный аргумент (код возврата: 0)
    - 3.3.4. Вывести справку если аргументы не переданы (код возврата: 1)
### 4. Аутентификация - 70 минут
* 4.1. Создать метод для проверки необходимости аутентифицировать (`args[0]=="-login" && args[2]=="-pass"`) - 10 минут
* 4.2. Создать метод для проверки валидности логина (R1.1) - 10 минут
* 4.3. Создать метод для проверки наличия введённого логина в БД (R1.1) - 10 минут
* 4.4. Создать метод для проверки валидности пароля (R1.1) - 10 минут
* 4.5. Создать метод для получения хэша введённого пароля (R1.2) - 20 минут
* 4.6. Создать метод для получения хэша пароля из БД (R1.2) - 10 минут
* 4.7. Создать метод для проверки двух хэшей (R1.1, R1.2) - 5 минут
* 4.8. Описать класс `User`, имеющий в конструкторе логин, хэш пароля - 5 минут
### 5. Авторизация - 90 минут
* 5.1. Описать класс `Handler` имеющий в конструкторе список аргументов - 30 минут
    - 5.1.1. Создать метод для обработки аргументов (R1.8, R1.10) - 20 минут
    - 5.1.2. Создать метод для проверки необходимости авторизации - 5 минут
    - 5.1.3. Создать метод для проверки существования переданной роли в базе - 5 минут
* 5.2. Описать класс `Resource` имеющий в конструкторе ресурс, логин, роль - 60 минут
    - 5.2.1. Создать метод для проверки валидности введённого ресурса  (R1.4) - 10 минут
    - 5.2.2. Создать метод для проверки наличия доступа юзера к ресурсу (R1.3) - 10 минут
    - 5.2.3. Создать метод для проверки вложенности ресурса и предоставления соответствующих доступов (R1.6) - 20 минут
    - 5.2.4. Создать метод для авторизации (R1.3) - 20 минут
### 6. Аккаунтинг - 50 минут
* 6.1. Создать метод для проверки необходимости аккаунтинга - 10 минут
* 6.2. Описать класс `Session`, имеющий в конструкторе объект класса `Resource`, время старта и конца, объём (R1.7) - 40 минут
    - 6.2.1. Создать метод для проверки валидности параметров время старта и конца (R1.7) - 10 минут
    - 6.2.2. Создать метод для обработки параметров время старта и конца (R1.7) - 10 минут
    - 6.2.3. Создать метод для проверки валидности введённого объёма (R1.7) - 10 минут
    - 6.2.4. Создать метод для обработки введённого объёма (R1.7) - 10 минут
### 7. Обработка аргументов - 70 минут
* 7.1. Подключить библиотеку `kotlinx.cli` для работы с аргументами (R1.10) - 10 минут
* 7.2. Описать возможные аргументы через `kotlinx.cli` (R1.10) - 60 минут

№ | Аргумент |Описание   |
--|--------|-------|
A1| -login      |Логин, строка из строчных латинских букв, длинной не более 10 символов  |
A2| -pass   |Пароль, строка |
A3| -res  |Путь до ресурса, строка формата A.B.C  |
A4| -role  |Роль доступа к ресурсу, строка. Варианты: READ, WRITE, EXECUTE   |
A5| -ds   |Дата начала сессии, строка формата YYYY-MM-DD|
A6| -de     |Дата окончания сессии, строка формата YYYY-MM-DD |
A7| -vol      |Потребляемый объём, целое число   | 
* 7.3. Изменить метод работы методов класса `Handler` для работы с `kotlinx.cli`


### Оценка времени:
№ | Ожидаемое время (мин) |Фактическое время (мин)   |
--|:--------:|:-------:|
**0.**|31| |
0.1.|1| |
0.2.|10| |
0.3.|10| |
0.4.|10 | |
**1.**|15| |
1.1.|5| |
1.2.|10| |
**2.**|40| |
2.1.|20| |
2.2.|10| |
2.3.|10| |
**3.**|20| |
3.1.|5| |
3.2.|10| |
3.3.|5| |
**4.**|80| |
4.1.|10| |
4.2.|10| |
4.3.|10| |
4.4.|10| |
4.5.|20| |
4.6.|10| |
4.7.|5| |
4.8.|5| |
**5.**|90| |
5.1.|30| |
*5.1.1.*|20| |
*5.1.2.*|5| |
*5.1.3.*|5| |
5.2.|60| |
*5.2.1.*|10| |
*5.2.2.*|10| |
*5.2.3.*|20| |
*5.2.4*.|20| |
**6.**|50| |
6.1.|10| |
6.2.|40| |
*6.2.1.*|10| |
*6.2.2.*|10| |
*6.2.3.*|20| |
*6.2.4.*|20| |
**7.**|70| |
7.1.|10| |
7.2.|60| |
**Всего**|396| |
